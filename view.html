<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Employee Summary</title>
<style>
body { font-family: Arial, sans-serif; padding: 20px; }
table { width: 100%; border-collapse: collapse; margin-top: 20px; }
th, td { border: 1px solid #333; padding: 8px; text-align: left; }
th { background-color: #f04e23; color: white; }
</style>
</head>
<body>

<h2>Employee Summary (All Dates)</h2>
<table id="summaryTable">
  <tr>
    <th>Date</th>
    <th>Site Name</th>
    <th>No. of Team Members</th>
  </tr>
</table>

<script>
const sheetURL = "https://script.google.com/macros/s/AKfycbxG_etzGXWEg9uK9TFciAKLp7_eJaWY_P-dO3LtNWNrvzRch7xuJ0xn3Xm7PFTUXlQt/exec"; // Replace with your web app URL

fetch(sheetURL)
  .then(res => res.json())
  .then(data => {
    const table = document.getElementById("summaryTable");

    // Group data by Date and Site
    const grouped = {};
    data.forEach(row => {
      const date = row["Date"];
      const site = row["Site Name"] || "â€”";
      if(!grouped[date]) grouped[date] = {};
      if(!grouped[date][site]) grouped[date][site] = 0;
      grouped[date][site]++;
    });

    Object.keys(grouped).sort().forEach(date => {
      Object.keys(grouped[date]).forEach(site => {
        const row = table.insertRow();
        row.insertCell(0).textContent = date;
        row.insertCell(1).textContent = site;
        row.insertCell(2).textContent = grouped[date][site];
      });
    });
  })
  .catch(err => console.error(err));
</script>

</body>
</html>
