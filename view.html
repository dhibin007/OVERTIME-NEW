<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Employee Overview</title>
<style>
  body { font-family: Arial; background:#f0f4f8; color:#333; padding:20px; }
  h1 { text-align:center; color:#262e87; }
  table { width:100%; border-collapse: collapse; margin-top:20px; background:#fff; box-shadow:0 4px 8px rgba(0,0,0,0.1); }
  th, td { padding:12px 15px; text-align:center; }
  th { background: linear-gradient(to right,#f04e23,#f7931e); color:#fff; font-size:16px; }
  tr:nth-child(even){ background:#f9f9f9; }
  tr:hover { background:#ffe0b2; }
  td.count { font-weight:bold; color:#3a2b7c; }
</style>
</head>
<body>

<h1>Employee Site Overview</h1>

<table id="overviewTable">
  <tr>
    <th>Date</th>
    <th>Site Name</th>
    <th>No of Team Members</th>
  </tr>
</table>

<script>
const SHEET_URL = "https://script.google.com/macros/s/AKfycbwaZruYkwMAqs9oDasaPHbinOqwnLAvy_9NlwDwPQSEONcG56ZTIhCXco7FRPaFYEg_/exec";

fetch(SHEET_URL)
.then(res => res.json())
.then(data => {
  const table = document.getElementById("overviewTable");

  const grouped = {};
  data.forEach(row=>{
    const date = row["Date"];
    const site = row["Site Name"];
    if(!date || !site) return;
    const key = date + "|" + site;
    if(!grouped[key]) grouped[key]=0;
    grouped[key]++;
  });

  Object.keys(grouped).sort().forEach(key=>{
    const [date, site] = key.split("|");
    const tr = document.createElement("tr");

    const tdDate = document.createElement("td"); tdDate.textContent=date; tr.appendChild(tdDate);
    const tdSite = document.createElement("td"); tdSite.textContent=site; tr.appendChild(tdSite);
    const tdCount = document.createElement("td"); tdCount.textContent=grouped[key]; tdCount.className="count"; tr.appendChild(tdCount);

    table.appendChild(tr);
  });
})
.catch(err=>console.error("Error fetching data:", err));
</script>

</body>
</html>
